## モデルに使えるクラスメソッド
モデルに対して使えるクラスメソッドとその使い方についてのまとめ。

- `new`メソッド<br/>
そのモデルに属するインスタンスを作成する。<br/>
DBには保存されないので、保存したい場合は`save`メソッドを使う<br/>
インスタンスの作成と保存を同時に行いたい場合は`create`メソッドを使う。

### レコードを取得するメソッド
- `all`メソッド<br/>
そのモデルに対応するテーブルからすべてのレコードを取得する。<br/>
モデルクラスのインスタンスではなく、`ActiveRecord::Relation`クラスが返ってくる。

- `find`メソッド<br/>
主キーに対応するレコードを取得する。<br/>
複数取得することが可能で、指定したIDの中に存在しないIDが1つでもあると例外が発生する。<br/>
モデルクラスのインスタンスが返ってくる。
```ruby
User.find(1） # UsersテーブルからIDが1のレコードを取得
User.find(2, 5) # 複数レコードを取得可能
User.find([3, 6]) # 配列で指定できる
```

- `find_by`メソッド<br/>
カラムと条件を指定して、最初の1件を取得する。<br/>
存在しない場合は`nil`を返す。<br/>
モデルクラスのインスタンスが返ってくる。
```ruby
User.find_by(age: 25) # 年齢が25歳のレコードの最初の1件を取得
User.find_by!(age: 25) # 年齢が25歳のレコードがない場合は、例外が発生
```

- `where`メソッド<br/>
条件に当てはまるレコードを全て取得する。<br/>
モデルクラスのインスタンスではなく、`ActiveRecord::Relation`クラスが返ってくる。
```ruby
# 文字列で指定
User.where("first_name = 'John'") # 文字列の中身がモデルが発行するSQLの中で使用される

# ハッシュで指定
User.where(first_name: 'John') # 1つの条件で検索する場合はシンボル形式で指定することが多い
```
`joins`メソッドでテーブルを結合している場合は、取得するテーブルを指定する。<br/>
テーブルの指定にはテーブル名を使う。
```ruby
Post.joins(:users).where(users: { country: 'Japan' })
```

### その他
- `order`メソッド<br/>
取得したレコードを指定したキーで並べ替える。
昇順は`:asc`、降順は`:desc`。
```ruby
# ユーザーの一覧を取得し、年齢で降順に並べ替える
User.all.order(age: :desc)
```

- `joins`メソッド<br/>
複数のテーブルを結合する。<br/>
指定するのはテーブル名ではなく、モデルで定義したアソシエーションの呼び出し方。
```ruby
Post.joins(:users)

# 複数のテーブルを結合
Post.joins(:users, :comments)

# ネストして結合（アソシエーションをさらに辿って取得）
# PostsテーブルとUsersテーブルを結合し、UsersテーブルとCountriesテーブルをさらに結合する
# PostsテーブルとCountriesテーブルにリレーションはない
Post.joins(users: :countries)
```
